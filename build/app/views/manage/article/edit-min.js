KISSY.add("app/views/manage/article/edit",function(a,e,t){return function(a){return a.prototype.template='<div class=article-edit> <div class=hd> <h3 class=title>\u6587\u7ae0\u7f16\u8f91</h3> </div> <div class=bd> {{#list}} <form id=editForm> <input type=hidden value="{{id}}" name=id> <ul class=union-form> <li class=field> <p class=field-label2>\u6807\u9898</p> <input type=text class=input name=title value="{{title}}"> </li> <li class=field> <p class=field-label2>\u5185\u5bb9</p> <textarea class=textarea name=content>{{{markdown}}}</textarea> </li> <li class=field> <a href="#" class="btn btn-small" mx-click=submit>\u53d1\u5e03</a> <a href="#" class="btn btn-small" mx-click=draft>\u4fdd\u5b58\u6210\u8349\u7a3f</a> </li> </ul> </form> {{/list}} </div> </div>',a}(e.extend({locationChange:function(){this.render()},render:function(){var a=this,e=a.location,i=e.params,l=i.id;a.manage(t.fetchAll([{name:"article_detail",urlParams:{id:l}}],function(e,t){var i=t.get("data");a.setViewPagelet({list:i},function(){a.components()})}))},components:function(){var a=new Editor;a.render(),this.manage("editor",a)},"submit<click>":function(e){e.halt();var i=this,l=i.getManaged("editor");l.codemirror.save();var n=a.unparam(a.IO.serialize("#editForm"));i.manage(t.fetchAll([{name:"article_update",postParams:n}],function(){i.navigate("/manage/article/list")}))},"draft<click>":function(e){e.halt();var i=this,l=i.getManaged("editor");l.codemirror.save();var n=a.unparam(a.IO.serialize("#editForm"));n.draft=1,i.manage(t.fetchAll([{name:"article_update",postParams:n}],function(){i.navigate("/manage/article/list")}))}}))},{requires:["mxext/view","app/models/modelmanager","magix/vom","magix/router","node","app/util/util"]});